---
- name: 'Install the Pipeline'
  hosts: localhost
  connection: local
  vars:
    app_name: 'quarkus-hello'
    app_namespace: 'dev-quarkus-hello'
    pipeline_namespace: 'sm-pipeline'
    gogs_namespace: 'gogs'
    reports_namespace: 'reports-repo'

    rhacs_operator_namespace: 'rhacs-operator'

    cluster_admin_token: 'sha256~rMbNJiHYf-ocQWtfAdE2gzNKbf0eNqCszXXZRR2fcCI'
    cluster_url: 'apps.cluster-tt4m8.dynamic.redhatworkshops.io'

    nexus_namespace: 'nexus'
    nexus_data_volume_capacity: '2Gi'
    nexus_url: "{{ nexus_namespace }}.{{ cluster_url }}"
    nexus_registry_url: "{{ nexus_namespace }}-registry.{{ cluster_url }}"
    nexus_image: 'registry.connect.redhat.com/sonatype/nexus-repository-manager:3.74.0-ubi-1'

    sonar_namespace: 'sonarqube'
    sonar_database_service_name: 'sonar-postgres'
    sonar_postgresql_database: 'sonar'
    sonar_postgresql_password: 'sonar'
    sonar_postgresql_user: 'sonar'
    sonar_postgresql_volume_capacity: '1Gi'
    sonar_postgresql_memory_limit: '512Mi'
    sonar_postgresql_version: '15-el9'
    sonar_postgresql_max_connections: '100'
    sonar_postgresql_shared_buffers: '12MB'
    sonar_postgresql_admin_password: 'sonar'
    sonar_data_volume_capacity: '2Gi'
    sonar_logs_volume_capacity: '2Gi'
    sonar_conf_volume_capacity: '2Gi'
    sonar_extensions_volume_capacity: '2Gi'
    sonar_image: 'sonarqube:9.9.7-community'
    sonar_url: "{{ sonar_namespace }}.{{ cluster_url }}"
    sonar_token: 'squ_dabcee1eac8ca583dbb9c676a70a826221864993'

  tasks:
#    - name: 'Install Gitops'
#      include_role:
#        name: "1-ocp4-install-gitops"

#    - name: 'Install CICD Infra'
#      include_role:
#        name: "2-ocp4-install-cicd"

#    - name: 'Install Pipelines'
#      include_role:
#        name: "3-ocp4-install-pipelines"

#    - name: '4-Config GitOps'
#      include_role:
#        name: "4-ocp4-config-gitops"

    - name: '5-Install the ACS Central'
      include_role:
        name: "5-ocp4-install-acs"

#    # Include the policies, and some content to show in the demo
#    - name: 'Install the ACS Post Content'
#      include_role:
#        name: "ocp4-post-acs"
